<<<<<<< HEAD
=======
/*
 * STOP!!! DO NOT MODIFY.
 *
 * This file is part of the ongoing work to move the eslintrc-style config
 * system into the @eslint/eslintrc package. This file needs to remain
 * unchanged in order for this work to proceed.
 *
 * If you think you need to change this file, please contact @nzakas first.
 *
 * Thanks in advance for your cooperation.
 */

>>>>>>> b459a022f47e1c55fb538e6c6b01f47908ccd92f
/**
 * Utility for resolving a module relative to another module
 * @author Teddy Katz
 */

"use strict";

const Module = require("module");
<<<<<<< HEAD
const path = require("path");

// Polyfill Node's `Module.createRequire` if not present. We only support the case where the argument is a filepath, not a URL.
const createRequire = (

    // Added in v12.2.0
    Module.createRequire ||

    // Added in v10.12.0, but deprecated in v12.2.0.
    Module.createRequireFromPath ||

    // Polyfill - This is not executed on the tests on node@>=10.
    /* istanbul ignore next */
    (filename => {
        const mod = new Module(filename, null);

        mod.filename = filename;
        mod.paths = Module._nodeModulePaths(path.dirname(filename)); // eslint-disable-line no-underscore-dangle
        mod._compile("module.exports = require;", filename); // eslint-disable-line no-underscore-dangle
        return mod.exports;
    })
);
=======

/*
 * `Module.createRequire` is added in v12.2.0. It supports URL as well.
 * We only support the case where the argument is a filepath, not a URL.
 */
// eslint-disable-next-line node/no-unsupported-features/node-builtins, node/no-deprecated-api
const createRequire = Module.createRequire || Module.createRequireFromPath;
>>>>>>> b459a022f47e1c55fb538e6c6b01f47908ccd92f

module.exports = {

    /**
     * Resolves a Node module relative to another module
     * @param {string} moduleName The name of a Node module, or a path to a Node module.
<<<<<<< HEAD
     *
=======
>>>>>>> b459a022f47e1c55fb538e6c6b01f47908ccd92f
     * @param {string} relativeToPath An absolute path indicating the module that `moduleName` should be resolved relative to. This must be
     * a file rather than a directory, but the file need not actually exist.
     * @returns {string} The absolute path that would result from calling `require.resolve(moduleName)` in a file located at `relativeToPath`
     */
    resolve(moduleName, relativeToPath) {
        try {
            return createRequire(relativeToPath).resolve(moduleName);
        } catch (error) {
<<<<<<< HEAD
=======

            // This `if` block is for older Node.js than 12.0.0. We can remove this block in the future.
>>>>>>> b459a022f47e1c55fb538e6c6b01f47908ccd92f
            if (
                typeof error === "object" &&
                error !== null &&
                error.code === "MODULE_NOT_FOUND" &&
                !error.requireStack &&
                error.message.includes(moduleName)
            ) {
                error.message += `\nRequire stack:\n- ${relativeToPath}`;
            }
            throw error;
        }
    }
};
