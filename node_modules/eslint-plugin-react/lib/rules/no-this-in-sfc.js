/**
 * @fileoverview Report "this" being used in stateless functional components.
 */

'use strict';

const Components = require('../util/Components');
const docsUrl = require('../util/docsUrl');

// ------------------------------------------------------------------------------
<<<<<<< HEAD
// Constants
// ------------------------------------------------------------------------------

const ERROR_MESSAGE = 'Stateless functional components should not use this';

// ------------------------------------------------------------------------------
=======
>>>>>>> b459a022f47e1c55fb538e6c6b01f47908ccd92f
// Rule Definition
// ------------------------------------------------------------------------------

module.exports = {
  meta: {
    docs: {
      description: 'Report "this" being used in stateless components',
      category: 'Possible Errors',
      recommended: false,
      url: docsUrl('no-this-in-sfc')
    },
<<<<<<< HEAD
=======

    messages: {
      noThisInSFC: 'Stateless functional components should not use `this`'
    },

>>>>>>> b459a022f47e1c55fb538e6c6b01f47908ccd92f
    schema: []
  },

  create: Components.detect((context, components, utils) => ({
    MemberExpression(node) {
      if (node.object.type === 'ThisExpression') {
        const component = components.get(utils.getParentStatelessComponent());
<<<<<<< HEAD
        if (!component || component.node && component.node.parent && component.node.parent.type === 'Property') {
=======
        if (!component || (component.node && component.node.parent && component.node.parent.type === 'Property')) {
>>>>>>> b459a022f47e1c55fb538e6c6b01f47908ccd92f
          return;
        }
        context.report({
          node,
<<<<<<< HEAD
          message: ERROR_MESSAGE
=======
          messageId: 'noThisInSFC'
>>>>>>> b459a022f47e1c55fb538e6c6b01f47908ccd92f
        });
      }
    }
  }))
};
